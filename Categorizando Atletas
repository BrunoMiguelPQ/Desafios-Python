from datetime import date
from kivy.app import App
from kivy.uix.boxlayout import BoxLayout
from kivy.uix.label import Label
from kivy.uix.textinput import TextInput
from kivy.uix.button import Button
from kivy.core.window import Window


class CategoriaApp(BoxLayout):
    def __init__(self, **kwargs):
        super().__init__(**kwargs)
        self.orientation = 'vertical'
        self.padding = 20
        self.spacing = 10
        self.size_hint = (None, None)
        self.width = 320
        self.height = 350
        self.pos_hint = {'center_x': 0.5, 'center_y': 0.5}

        # Título no topo
        self.title_label = Label(
            text="Verificar a sua Categoria",
            size_hint=(1, None),
            height=40,
            font_size=18,
            bold=True,
            halign='center',
            color=(0, 0, 0, 1)
        )
        self.title_label.text_size = (self.width - 20, None)
        self.add_widget(self.title_label)

        # Entrada do ano
        self.nascimento_input = TextInput(
            hint_text="Digite o ano de nascimento",
            multiline=False,
            input_filter='int',
            size_hint=(1, None),
            height=40,
            foreground_color=(0, 0, 0, 1)
        )
        self.add_widget(self.nascimento_input)

        # Resultado
        self.result_label = Label(
            text="Preencha o ano e clique em 'Ver categoria'",
            size_hint=(1, None),
            height=100,
            halign='center',
            valign='middle',
            color=(0, 0, 0, 1)
        )
        self.result_label.text_size = (self.width - 40, None)
        self.add_widget(self.result_label)

        # Botão Ver categoria
        calcular_btn = Button(
            text="Ver categoria",
            size_hint=(1, None),
            height=40
        )
        calcular_btn.bind(on_press=self.verificar_categoria)
        self.add_widget(calcular_btn)

        # Botão Limpar
        limpar_btn = Button(
            text="Limpar",
            size_hint=(1, None),
            height=40
        )
        limpar_btn.bind(on_press=self.limpar)
        self.add_widget(limpar_btn)

    def verificar_categoria(self, instance):
        try:
            nascimento = int(self.nascimento_input.text)
            atual = date.today().year
            idade = atual - nascimento

            if idade <= 9:
                categoria = 'MIRIM'
            elif idade <= 14:
                categoria = 'INFANTIL'
            elif idade <= 19:
                categoria = 'JUNIOR'
            elif idade <= 25:
                categoria = 'SENIOR'
            else:
                categoria = 'MASTER'

            self.result_label.text = f"Idade: {idade} anos\nCategoria: {categoria}"
        except ValueError:
            self.result_label.text = "Por favor, digite um ano válido."

    def limpar(self, instance):
        self.nascimento_input.text = ''
        self.result_label.text = "Preencha o ano e clique em 'Ver categoria'"


class CategoriaAppApp(App):
    def build(self):
        Window.clearcolor = (1, 1, 1, 1)  # fundo branco
        return CategoriaApp()


if __name__ == '__main__':
    CategoriaAppApp().run()
